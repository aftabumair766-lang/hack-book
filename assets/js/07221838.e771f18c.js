"use strict";(self.webpackChunkhack_book=self.webpackChunkhack_book||[]).push([[922],{7214:(e,n,r)=>{r.d(n,{A:()=>d});var s=r(2444),i=r(467),a=r(6540),o=r(9092);const t={personalizeContainer:"personalizeContainer_sZZV",personalizeButton:"personalizeButton_Amum",icon:"icon_NDbS",sparkle:"sparkle_wYJM",spinner:"spinner_U1jo",spin:"spin_BoGZ",successMessage:"successMessage_DLUR",checkIcon:"checkIcon_Lxj5",error:"error_xR2t",errorLink:"errorLink_ErXl",hint:"hint_a5yL"};var l=r(4848),c="undefined"!=typeof window&&"localhost"!==window.location.hostname?"https://your-backend-url.com":"http://localhost:8000";function d(e){var n=e.chapterId,r=e.onPersonalize,d=(0,o.A)(),h=d.user,u=d.token,p=d.isAuthenticated,x=(0,a.useState)(!1),m=x[0],j=x[1],g=(0,a.useState)(""),f=g[0],b=g[1],k=(0,a.useState)(!1),z=k[0],_=k[1],v=function(){var e=(0,i.A)((0,s.A)().m(function e(){var i,a,o,t;return(0,s.A)().w(function(e){for(;;)switch(e.p=e.n){case 0:if(p&&u){e.n=1;break}return b("Please sign in to personalize content"),e.a(2);case 1:if(null!=h&&h.has_completed_questionnaire){e.n=2;break}return b("Please complete the background questionnaire first"),e.a(2);case 2:return j(!0),b(""),e.p=3,e.n=4,fetch(c+"/api/personalize/chapter",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+u},body:JSON.stringify({chapter_id:n})});case 4:if((i=e.v).ok){e.n=6;break}return e.n=5,i.json();case 5:throw a=e.v,new Error(a.detail||"Failed to personalize content");case 6:return e.n=7,i.json();case 7:o=e.v,r&&r(o),_(!0),e.n=9;break;case 8:e.p=8,t=e.v,b(t.message),console.error("Personalization error:",t);case 9:return e.p=9,j(!1),e.f(9);case 10:return e.a(2)}},e,null,[[3,8,9,10]])}));return function(){return e.apply(this,arguments)}}();return p?(0,l.jsxs)("div",{className:t.personalizeContainer,children:[z?(0,l.jsxs)("div",{className:t.successMessage,children:[(0,l.jsx)("span",{className:t.checkIcon,children:"\u2713"}),"Content personalized for your profile!"]}):(0,l.jsx)("button",{onClick:v,disabled:m,className:t.personalizeButton,children:m?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("span",{className:t.spinner}),"Personalizing..."]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("span",{className:t.icon,children:"\u2728"}),"Personalize This Chapter"]})}),f&&(0,l.jsxs)("div",{className:t.error,children:[f,f.includes("questionnaire")&&(0,l.jsx)("a",{href:"/questionnaire",className:t.errorLink,children:"Complete questionnaire \u2192"})]}),!(null!=h&&h.has_completed_questionnaire)&&p&&(0,l.jsxs)("div",{className:t.hint,children:["\ud83d\udca1 Complete your ",(0,l.jsx)("a",{href:"/questionnaire",children:"background questionnaire"})," to enable personalization"]})]}):null}},7751:(e,n,r)=>{r.r(n),r.d(n,{default:()=>l});var s=r(6540),i=r(4282),a=r(9092),o=r(7214),t=r(4848);function l(){var e=(0,a.A)(),n=e.user,r=e.isAuthenticated,l=(0,s.useState)(null),c=l[0],d=l[1];return(0,t.jsx)(i.A,{title:"Test Personalization",children:(0,t.jsxs)("div",{style:{maxWidth:"1200px",margin:"2rem auto",padding:"0 2rem"},children:[(0,t.jsx)("h1",{children:"\ud83e\uddea Personalization System Test Page"}),(0,t.jsxs)("div",{style:{padding:"1.5rem",background:"rgba(0, 217, 255, 0.1)",border:"1px solid #00d9ff",borderRadius:"8px",marginBottom:"2rem"},children:[(0,t.jsx)("h2",{children:"Authentication Status"}),(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"Logged In:"})," ",r?"\u2705 Yes":"\u274c No"]}),n&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"Email:"})," ",n.email]}),(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"Questionnaire Completed:"})," ",n.has_completed_questionnaire?"\u2705 Yes":"\u274c No"]})]}),!r&&(0,t.jsxs)("p",{style:{color:"#ff4444"},children:["Please ",(0,t.jsx)("a",{href:"/signup",children:"sign up"})," or ",(0,t.jsx)("a",{href:"/signin",children:"sign in"})," to test personalization."]}),r&&!(null!=n&&n.has_completed_questionnaire)&&(0,t.jsxs)("p",{style:{color:"#ffc107"},children:["Please complete the ",(0,t.jsx)("a",{href:"/questionnaire",children:"questionnaire"})," to enable personalization."]})]}),(0,t.jsxs)("div",{style:{padding:"1.5rem",background:"rgba(0, 217, 255, 0.05)",border:"1px solid #00d9ff",borderRadius:"8px",marginBottom:"2rem"},children:[(0,t.jsx)("h2",{children:"Personalization Test"}),(0,t.jsx)(o.A,{chapterId:"chapter-01",onPersonalize:function(e){console.log("Personalization data received:",e),d(e)}})]}),c&&(0,t.jsxs)("div",{style:{padding:"1.5rem",background:"rgba(0, 255, 100, 0.05)",border:"1px solid #0f0",borderRadius:"8px",marginBottom:"2rem"},children:[(0,t.jsx)("h2",{children:"\u2705 Personalization Result"}),(0,t.jsx)("h3",{children:"Profile Summary:"}),(0,t.jsx)("pre",{style:{background:"#1e1e1e",padding:"1rem",borderRadius:"4px",overflow:"auto"},children:JSON.stringify(c.user_profile_summary,null,2)}),(0,t.jsx)("h3",{children:"Transformations Applied:"}),(0,t.jsx)("ul",{children:c.transformations_applied.map(function(e,n){return(0,t.jsx)("li",{children:e},n)})}),(0,t.jsx)("h3",{children:"Content Length:"}),(0,t.jsxs)("p",{children:["Original: ",c.original_length," characters"]}),(0,t.jsxs)("p",{children:["Personalized: ",c.personalized_length," characters"]}),(0,t.jsx)("h3",{children:"Personalized Content Preview (first 500 chars):"}),(0,t.jsxs)("pre",{style:{background:"#1e1e1e",padding:"1rem",borderRadius:"4px",overflow:"auto",whiteSpace:"pre-wrap"},children:[c.personalized_content.substring(0,500),"..."]})]}),(0,t.jsxs)("div",{style:{padding:"1.5rem",background:"rgba(136, 136, 136, 0.1)",border:"1px solid #666",borderRadius:"8px"},children:[(0,t.jsx)("h2",{children:"Test Instructions"}),(0,t.jsxs)("ol",{children:[(0,t.jsx)("li",{children:"Make sure you're signed in"}),(0,t.jsx)("li",{children:"Complete the background questionnaire if you haven't"}),(0,t.jsx)("li",{children:'Click the "Personalize This Chapter" button above'}),(0,t.jsx)("li",{children:"Check the result below"}),(0,t.jsx)("li",{children:"Open browser console (F12) for detailed logs"})]})]})]})})}}}]);